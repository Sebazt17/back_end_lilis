{% extends "mantenedores/paginaBase.html" %}
{% load static %}

{% block titulo %}
<h2 class="fw-bold text-center mb-4"></h2>
{% endblock titulo %}

{% block contenido %}

<style>
.auth-card {
    background: white;
    border-radius: 20px;
    width: 90%;
    max-width: 900px;
    padding: 2.5rem;
    box-shadow: 0 8px 25px rgba(0,0,0,0.22);
    border: 2px solid #ffeaea;
    animation: fadeSlide .6s ease-out;
}
@keyframes fadeSlide { from {opacity:0; transform: translateY(50px);} to{opacity:1; transform: translateY(0);} }

input.is-invalid, select.is-invalid {
    border: 2px solid #b22222 !important;
}
</style>


<div class="d-flex justify-content-center align-items-start py-4">
<div class="auth-card">

    <h3 class="fw-bold text-center" style="color:#b22222;">Editar Usuario</h3>
    <p class="text-center text-muted">Modifique los datos necesarios</p>

    <form id="formEditarUsuario" method="post" novalidate>
        {% csrf_token %}

        <div class="row">
            <div class="col-md-6 mb-3">
                {{ form.username.label_tag }}
                {{ form.username }}
                {% if form.username.errors %}
                    <p class="text-danger small fw-bold">{{ form.username.errors.0 }}</p>
                {% endif %}
            </div>

            <div class="col-md-6 mb-3">
                {{ form.email.label_tag }}
                {{ form.email }}
                {% if form.email.errors %}
                    <p class="text-danger small fw-bold">{{ form.email.errors.0 }}</p>
                {% endif %}
            </div>

            <div class="col-md-6 mb-3">
                {{ form.first_name.label_tag }}
                {{ form.first_name }}
                {% if form.first_name.errors %}
                    <p class="text-danger small fw-bold">{{ form.first_name.errors.0 }}</p>
                {% endif %}
            </div>

            <div class="col-md-6 mb-3">
                {{ form.last_name.label_tag }}
                {{ form.last_name }}
                {% if form.last_name.errors %}
                    <p class="text-danger small fw-bold">{{ form.last_name.errors.0 }}</p>
                {% endif %}
            </div>

            <div class="col-md-6 mb-3">
                {{ form.rol.label_tag }}
                {{ form.rol }}
            </div>

            <div class="col-md-6 mb-3">
                {{ form.estado.label_tag }}
                {{ form.estado }}
            </div>
        </div>

        <div class="d-flex justify-content-center gap-3 mt-4">
            <button type="submit" class="btn btn-warning px-4">Guardar</button>
            <a href="{% url 'accounts_lilis:usuario_listar' %}" class="btn btn-outline-danger px-4">Volver</a>
        </div>

        <input type="hidden" id="editarUsuarioFlag" value="1">
    </form>

</div>
</div>


<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

<script>

document.querySelectorAll("input, select").forEach(campo => {
    if (campo.nextElementSibling && campo.nextElementSibling.classList.contains("text-danger")) {
        campo.classList.add("is-invalid");
    }
});

document.getElementById("formEditarUsuario").addEventListener("submit", function (e) {
    e.preventDefault(); 

    Swal.fire({
        title: "¿Guardar cambios?",
        text: "Los datos del usuario serán actualizados.",
        icon: "warning",
        showCancelButton: true,
        confirmButtonColor: "#b22222",
        cancelButtonColor: "#6c757d",
        confirmButtonText: "Sí, guardar cambios",
        cancelButtonText: "Cancelar"
    }).then((result) => {
        if (result.isConfirmed) {
            this.submit();
        }
    });
});

</script>

{% endblock contenido %}
